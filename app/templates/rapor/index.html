{% extends "base.html" %}
{% block title %}Rapor Merkezi{% endblock %}

{% block extra_css %}
<style>
    .hover-shadow:hover { 
        transform: translateY(-5px); 
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important; 
    }
    .transition-card { 
        transition: all 0.3s ease; 
    }
    .icon-box {
        width: 64px; 
        height: 64px;
        transition: transform 0.3s;
    }
    .transition-card:hover .icon-box {
        transform: scale(1.1);
    }
    .category-header {
        border-left: 4px solid #667eea;
        padding-left: 15px;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }
    .ai-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
    }
    .badge-new {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        font-size: 0.7rem;
        padding: 0.2rem 0.5rem;
        border-radius: 10px;
        margin-left: 0.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <!-- BaÅŸlÄ±k -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h3 class="fw-bold mb-1">
                <i class="bi bi-graph-up me-2"></i>Rapor Merkezi
            </h3>
            <p class="text-muted mb-0">Ä°ÅŸletmenizin tÃ¼m analiz ve raporlama merkezine hoÅŸ geldiniz</p>
        </div>
        <div>
            <a href="{{ url_for('rapor.gecmis_raporlar') }}" class="btn btn-outline-secondary">
                <i class="bi bi-clock-history"></i> Rapor ArÅŸivi
            </a>
        </div>
    </div>

    <!-- ===================================== -->
    <!-- ðŸ¤– AI CEO BRÄ°FÄ°NG KARTI -->
    <!-- ===================================== -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-lg ai-card">
                <div class="card-body p-4 text-white">
                    <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                        <div>
                            <h4 class="fw-bold mb-1">
                                <i class="bi bi-robot me-2"></i>AI YÃ¶netici Ã–zeti
                                <span class="badge-new">YENÄ°</span>
                            </h4>
                            <p class="text-white-50 mb-0">
                                GÃ¼naydÄ±n, <strong>{{ current_user.ad_soyad }}</strong>! 
                                Yapay zeka destekli gÃ¼nlÃ¼k ÅŸirket Ã¶zetiniz hazÄ±r.
                            </p>
                        </div>
                        <div>
                            <a href="{{ url_for('rapor.ai_ayarlari') }}" class="btn btn-outline-light btn-sm me-2">
                                <i class="bi bi-sliders"></i> Ayarlar
                            </a>
                            <button onclick="brifingGetir()" class="btn btn-warning fw-bold shadow">
                                <i class="bi bi-lightning-charge-fill me-1"></i> Analizi Ã‡alÄ±ÅŸtÄ±r
                            </button>
                        </div>
                    </div>
                    
                    <!-- AI Rapor AlanÄ± -->
                    <div id="ceoRaporAlani" class="mt-4 d-none bg-white text-dark p-4 rounded shadow-sm animate__animated animate__fadeIn">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===================================== -->
    <!-- ðŸ“š RESMÄ° DEFTERLER & MUHASEBE -->
    <!-- ===================================== -->
    <div class="category-header">
        <h5 class="mb-0 text-dark fw-bold">
            <i class="bi bi-journal-text me-2"></i>Resmi Defterler & Muhasebe
        </h5>
        <small class="text-muted">Yasal zorunlu kayÄ±t ve dÃ¶kÃ¼mler</small>
    </div>

    <div class="row g-4 mb-4">
        <!-- Yevmiye Defteri -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-info bg-opacity-10 text-info mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-journal-bookmark-fill fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Yevmiye Defteri</h6>
                    <p class="card-text text-muted small">GÃ¼nlÃ¼k fiÅŸ kayÄ±tlarÄ± ve madde dÃ¶kÃ¼mÃ¼</p>
                    <a href="{{ url_for('rapor.yevmiye_defteri') }}" class="btn btn-outline-info stretched-link btn-sm">
                        Defteri AÃ§
                    </a>
                </div>
            </div>
        </div>

        <!-- BÃ¼yÃ¼k Defter -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-primary bg-opacity-10 text-primary mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-book-half fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">BÃ¼yÃ¼k Defter</h6>
                    <p class="card-text text-muted small">Hesap bazlÄ± muavin dÃ¶kÃ¼mleri</p>
                    <button class="btn btn-sm btn-outline-secondary disabled">YakÄ±nda</button>
                </div>
            </div>
        </div>

        <!-- Genel Mizan -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-danger bg-opacity-10 text-danger mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-calculator fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Genel Mizan</h6>
                    <p class="card-text text-muted small">BorÃ§/alacak bakiyeleri</p>
                    <a href="{{ url_for('muhasebe.mizan') }}" class="btn btn-outline-danger stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Gelir Tablosu -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-success bg-opacity-10 text-success mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-file-bar-graph fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Gelir Tablosu</h6>
                    <p class="card-text text-muted small">KÃ¢r-zarar hesaplamalarÄ±</p>
                    <a href="{{ url_for('rapor.gelir_gider') }}" class="btn btn-outline-success stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ===================================== -->
    <!-- ðŸ“ˆ SATIÅž & CÄ°RO RAPORLARI -->
    <!-- ===================================== -->
    <div class="category-header">
        <h5 class="mb-0 text-dark fw-bold">
            <i class="bi bi-cart-check me-2"></i>SatÄ±ÅŸ & Ciro RaporlarÄ±
        </h5>
        <small class="text-muted">SatÄ±ÅŸ performansÄ± ve trend analizleri</small>
    </div>

    <div class="row g-4 mb-4">
        <!-- AylÄ±k SatÄ±ÅŸ -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-primary bg-opacity-10 text-primary mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-graph-up fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">AylÄ±k SatÄ±ÅŸ Raporu</h6>
                    <p class="card-text text-muted small">Ay bazÄ±nda satÄ±ÅŸ trendi</p>
                    <a href="{{ url_for('raporlar.aylik_satis') }}" class="btn btn-outline-primary stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- ÃœrÃ¼n BazlÄ± -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-success bg-opacity-10 text-success mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-box-seam fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">ÃœrÃ¼n BazlÄ± SatÄ±ÅŸ</h6>
                    <p class="card-text text-muted small">En Ã§ok satan Ã¼rÃ¼nler</p>
                    <a href="{{ url_for('raporlar.urun_bazli_satis') }}" class="btn btn-outline-success stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- MÃ¼ÅŸteri BazlÄ± -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-info bg-opacity-10 text-info mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-people fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">MÃ¼ÅŸteri BazlÄ± SatÄ±ÅŸ</h6>
                    <p class="card-text text-muted small">Ciro sÄ±ralamasÄ±</p>
                    <a href="{{ url_for('raporlar.musteri_bazli_satis') }}" class="btn btn-outline-info stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Plasiyer Performans -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-warning bg-opacity-10 text-warning mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-person-lines-fill fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Plasiyer Analizi</h6>
                    <p class="card-text text-muted small">Personel performansÄ±</p>
                    <a href="{{ url_for('rapor.plasiyer_performans') }}" class="btn btn-outline-warning stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ===================================== -->
    <!-- ðŸ’° CARÄ° & FÄ°NANS RAPORLARI -->
    <!-- ===================================== -->
    <div class="category-header">
        <h5 class="mb-0 text-dark fw-bold">
            <i class="bi bi-wallet2 me-2"></i>Cari & Finans RaporlarÄ±
        </h5>
        <small class="text-muted">Alacak-borÃ§ yÃ¶netimi ve nakit akÄ±ÅŸÄ±</small>
    </div>

    <div class="row g-4 mb-4">
        <!-- Cari Ekstre -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-success bg-opacity-10 text-success mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-file-earmark-spreadsheet fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Cari Ekstre</h6>
                    <p class="card-text text-muted small">DetaylÄ± hesap dÃ¶kÃ¼mÃ¼</p>
                    <a href="{{ url_for('rapor.cari_ekstre') }}" class="btn btn-outline-success stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Cari Bakiye -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-primary bg-opacity-10 text-primary mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-person-badge fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Cari Bakiye Listesi</h6>
                    <p class="card-text text-muted small">Alacak/borÃ§ durumu</p>
                    <a href="{{ url_for('raporlar.cari_bakiye') }}" class="btn btn-outline-primary stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Vade Analizi -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-danger bg-opacity-10 text-danger mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-calendar-x fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Vade Analizi</h6>
                    <p class="card-text text-muted small">Vadesi gelen Ã§ekler</p>
                    <a href="{{ url_for('raporlar.vade_analizi') }}" class="btn btn-outline-danger stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Nakit AkÄ±ÅŸ -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-info bg-opacity-10 text-info mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-cash-stack fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Nakit AkÄ±ÅŸ</h6>
                    <p class="card-text text-muted small">GiriÅŸ-Ã§Ä±kÄ±ÅŸ raporu</p>
                    <a href="{{ url_for('raporlar.nakit_akis') }}" class="btn btn-outline-info stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ===================================== -->
    <!-- ðŸ“¦ STOK & ENVANTER -->
    <!-- ===================================== -->
    <div class="category-header">
        <h5 class="mb-0 text-dark fw-bold">
            <i class="bi bi-boxes me-2"></i>Stok & Envanter RaporlarÄ±
        </h5>
        <small class="text-muted">Depo yÃ¶netimi ve maliyet analizi</small>
    </div>

    <div class="row g-4 mb-4">
        <!-- Stok Durum -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-primary bg-opacity-10 text-primary mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-box-seam fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Stok Durum Raporu</h6>
                    <p class="card-text text-muted small">AnlÄ±k envanter durumu</p>
                    <a href="{{ url_for('rapor.stok_durum') }}" class="btn btn-outline-primary stretched-link btn-sm">
                        GÃ¶rÃ¼ntÃ¼le
                    </a>
                </div>
            </div>
        </div>

        <!-- Stok Hareket -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-success bg-opacity-10 text-success mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-arrow-left-right fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Stok Hareket</h6>
                    <p class="card-text text-muted small">GiriÅŸ-Ã§Ä±kÄ±ÅŸ hareketleri</p>
                    <button class="btn btn-sm btn-outline-secondary disabled">YakÄ±nda</button>
                </div>
            </div>
        </div>

        <!-- Kritik Stok -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-warning bg-opacity-10 text-warning mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-exclamation-triangle fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">Kritik Stok</h6>
                    <p class="card-text text-muted small">Minimum seviye altÄ± Ã¼rÃ¼nler</p>
                    <button class="btn btn-sm btn-outline-secondary disabled">YakÄ±nda</button>
                </div>
            </div>
        </div>

        <!-- ABC Analizi -->
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 shadow-sm border-0 hover-shadow transition-card">
                <div class="card-body text-center p-4">
                    <div class="icon-box bg-info bg-opacity-10 text-info mb-3 mx-auto rounded-circle d-flex align-items-center justify-content-center">
                        <i class="bi bi-bar-chart-steps fs-2"></i>
                    </div>
                    <h6 class="card-title fw-bold">ABC Analizi</h6>
                    <p class="card-text text-muted small">Ã–ncelik sÄ±ralamasÄ±</p>
                    <button class="btn btn-sm btn-outline-secondary disabled">YakÄ±nda</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function brifingGetir() {
    // UI GÃ¼ncelleme
    $('#ceoRaporAlani').removeClass('d-none').html(`
        <div class="text-center py-4">
            <div class="spinner-border text-info" role="status" style="width: 3rem; height: 3rem;"></div>
            <h5 class="mt-3 animate__animated animate__pulse animate__infinite">
                Yapay Zeka Verileri Analiz Ediyor...
            </h5>
            <p class="text-muted">Stok, Finans ve Risk modÃ¼lleri taranÄ±yor...</p>
        </div>
    `);
    
    // API Ä°steÄŸi
    $.ajax({
        url: '/rapor/api/ceo-brifing-olustur',
        method: 'POST',
        success: function(res) {
            if(res.success) {
                $('#ceoRaporAlani').hide().html(res.report).fadeIn(800);
            } else {
                $('#ceoRaporAlani').html(`
                    <div class="alert alert-danger d-flex align-items-center">
                        <i class="bi bi-exclamation-triangle-fill fs-4 me-3"></i>
                        <div><strong>Hata:</strong> ${res.message}</div>
                    </div>
                `);
            }
        },
        error: function() {
            $('#ceoRaporAlani').html(`
                <div class="alert alert-danger">
                    <strong>Sunucu HatasÄ±:</strong> Analiz servisine ulaÅŸÄ±lamadÄ±.
                </div>
            `);
        }
    });
}
</script>
{% endblock %}