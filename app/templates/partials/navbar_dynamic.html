<!-- templates/partials/navbar_dynamic.html (DÜZELTİLMİŞ) -->

{% macro render_menu_item(item) %}
    {% if item.children and item.children|length > 0 %}
        <!-- ✅ DROPDOWN MENÜ (Alt menüsü var) -->
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle {{ 'active text-primary fw-bold' if request.path == item.url else '' }}" 
               href="#" 
               id="navbarDropdown{{ item.id }}"
               role="button" 
               data-bs-toggle="dropdown" 
               aria-expanded="false">
                <i class="{{ item.icon }}"></i> {{ item.baslik }}
            </a>
            <ul class="dropdown-menu animated fadeIn shadow border-0" aria-labelledby="navbarDropdown{{ item.id }}">
                <li><h6 class="dropdown-header text-uppercase small">{{ item.baslik }}</h6></li>
                <li><hr class="dropdown-divider"></li>
                
                {% for child in item.children %}
                    {{ render_menu_item(child) }}
                {% endfor %}
            </ul>
        </li>
    {% else %}
        <!-- ✅ TEK LİNK (Alt menüsü yok) -->
        {% if item.get('parent_id') %}
            <!-- Alt menü item -->
            <li>
                <a class="dropdown-item {{ 'active fw-bold' if request.path == item.url else '' }}" 
                   href="{{ item.url }}">
                    <i class="{{ item.icon }} me-2 {{ 'text-primary' if request.path == item.url else 'text-muted' }}"></i> 
                    {{ item.baslik }}
                </a>
            </li>
        {% else %}
            <!-- Ana menü item (alt menüsü yok) -->
            <li class="nav-item">
                <a class="nav-link {{ 'active text-primary fw-bold' if request.path == item.url else '' }}" 
                   href="{{ item.url }}">
                    <i class="{{ item.icon }}"></i> {{ item.baslik }}
                </a>
            </li>
        {% endif %}
    {% endif %}
{% endmacro %}

<ul class="navbar-nav me-auto mb-2 mb-lg-0">
    {% for item in dynamic_menu %}
        {{ render_menu_item(item) }}
    {% endfor %}
</ul>