# tests/fatura_test.py

import sys
import os

# Proje kÃ¶k dizinini Python path'e ekle
BASE_DIR = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
sys.path.insert(0, BASE_DIR)

# Åimdi import et
from app.app import app, db
from app.models import Fatura
from app.modules.fatura.services import FaturaService

def test_fatura_get_by_id():
    """Fatura kalemlerini test et"""
    
    with app.app_context():
        fatura = FaturaService.get_by_id(1, firma_id=1)
        
        if fatura:
            print(f"âœ… Fatura:  {fatura.belge_no}")
            print(f"âœ… Kalem SayÄ±sÄ±: {len(fatura.kalemler)}")
            
            for i, kalem in enumerate(fatura.kalemler):
                print(f"\nğŸ“¦ Kalem {i+1}:")
                print(f"  - ID: {kalem.id}")
                print(f"  - Stok ID: {kalem.stok_id}")
                print(f"  - Stok AdÄ±: {kalem.stok.ad if kalem.stok else 'âš ï¸ YOK'}")
                print(f"  - Miktar: {kalem.miktar}")
                print(f"  - Birim Fiyat: {kalem.birim_fiyat}")
                print(f"  - SatÄ±r ToplamÄ±: {kalem.satir_toplami}")
        else:
            print("âŒ Fatura bulunamadÄ±!")

if __name__ == '__main__':
    test_fatura_get_by_id()